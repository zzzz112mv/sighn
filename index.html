<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국수화 인식기</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mediapipe/0.10.14/hands.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mediapipe/0.10.14/camera_utils.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mediapipe/0.10.14/control_utils.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mediapipe/0.10.14/drawing_utils.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            padding: 20px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .camera-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        #video {
            width: 100%;
            height: auto;
            display: block;
            transform: scaleX(-1);
        }

        .canvas-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            transform: scaleX(-1);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            min-width: 120px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn.secondary {
            background: linear-gradient(45deg, #3742fa, #2f3542);
        }

        .btn.success {
            background: linear-gradient(45deg, #2ed573, #1e90ff);
        }

        .output-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .output-text {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 20px;
            min-height: 120px;
            font-size: 1.2rem;
            line-height: 1.6;
            border: 2px solid rgba(255,255,255,0.1);
            word-wrap: break-word;
        }

        .recognition-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff6b6b;
            animation: pulse 2s infinite;
        }

        .status-dot.active {
            background: #2ed573;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .confidence-indicator {
            margin-top: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            padding: 10px;
        }

        .confidence-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(45deg, #2ed573, #1e90ff);
            width: 0%;
            transition: width 0.3s ease;
        }

        .database-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .db-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-align: center;
        }

        .sign-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .sign-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .sign-item.recognized {
            background: rgba(46, 213, 115, 0.4);
            transform: scale(1.1);
        }

        .words-section {
            margin-top: 20px;
        }

        .word-item {
            background: rgba(255,255,255,0.15);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .word-item.recognized {
            background: rgba(46, 213, 115, 0.4);
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .container {
                padding: 15px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 250px;
            }
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.1rem;
        }

        .debug-info {
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.8rem;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">🤟 한국수화 인식기</h1>
            <p class="subtitle">AI 기반 실시간 수화 인식 및 텍스트 변환</p>
        </div>

        <div class="camera-section">
            <div class="recognition-status">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText">카메라 대기중...</span>
            </div>
            
            <div class="video-container">
                <video id="video" autoplay muted playsinline></video>
                <canvas id="canvas" class="canvas-overlay"></canvas>
            </div>

            <div class="confidence-indicator">
                <div>인식 신뢰도: <span id="confidenceText">0%</span></div>
                <div class="confidence-bar">
                    <div class="confidence-fill" id="confidenceFill"></div>
                </div>
            </div>

            <div class="controls">
                <button class="btn" id="startBtn">카메라 시작</button>
                <button class="btn secondary" id="recognizeBtn" disabled>수화 인식</button>
                <button class="btn success" id="speakBtn" disabled>음성 출력</button>
                <button class="btn secondary" id="clearBtn">텍스트 지우기</button>
            </div>

            <div class="debug-info" id="debugInfo">
                손 인식 대기 중...
            </div>
        </div>

        <div class="output-section">
            <h3>인식 결과:</h3>
            <div class="output-text" id="outputText">수화를 인식하면 여기에 텍스트가 나타납니다.</div>
        </div>

        <div class="database-section">
            <h3 class="db-title">📚 수화 데이터베이스</h3>
            
            <h4>자음 (19개)</h4>
            <div class="sign-grid" id="consonants">
                <div class="sign-item" data-sign="ㄱ">ㄱ</div>
                <div class="sign-item" data-sign="ㄴ">ㄴ</div>
                <div class="sign-item" data-sign="ㄷ">ㄷ</div>
                <div class="sign-item" data-sign="ㄹ">ㄹ</div>
                <div class="sign-item" data-sign="ㅁ">ㅁ</div>
                <div class="sign-item" data-sign="ㅂ">ㅂ</div>
                <div class="sign-item" data-sign="ㅅ">ㅅ</div>
                <div class="sign-item" data-sign="ㅇ">ㅇ</div>
                <div class="sign-item" data-sign="ㅈ">ㅈ</div>
                <div class="sign-item" data-sign="ㅊ">ㅊ</div>
                <div class="sign-item" data-sign="ㅋ">ㅋ</div>
                <div class="sign-item" data-sign="ㅌ">ㅌ</div>
                <div class="sign-item" data-sign="ㅍ">ㅍ</div>
                <div class="sign-item" data-sign="ㅎ">ㅎ</div>
                <div class="sign-item" data-sign="ㄲ">ㄲ</div>
                <div class="sign-item" data-sign="ㄸ">ㄸ</div>
                <div class="sign-item" data-sign="ㅃ">ㅃ</div>
                <div class="sign-item" data-sign="ㅆ">ㅆ</div>
                <div class="sign-item" data-sign="ㅉ">ㅉ</div>
            </div>

            <h4>모음 (21개)</h4>
            <div class="sign-grid" id="vowels">
                <div class="sign-item" data-sign="ㅏ">ㅏ</div>
                <div class="sign-item" data-sign="ㅑ">ㅑ</div>
                <div class="sign-item" data-sign="ㅓ">ㅓ</div>
                <div class="sign-item" data-sign="ㅕ">ㅕ</div>
                <div class="sign-item" data-sign="ㅗ">ㅗ</div>
                <div class="sign-item" data-sign="ㅛ">ㅛ</div>
                <div class="sign-item" data-sign="ㅜ">ㅜ</div>
                <div class="sign-item" data-sign="ㅠ">ㅠ</div>
                <div class="sign-item" data-sign="ㅡ">ㅡ</div>
                <div class="sign-item" data-sign="ㅣ">ㅣ</div>
                <div class="sign-item" data-sign="ㅐ">ㅐ</div>
                <div class="sign-item" data-sign="ㅒ">ㅒ</div>
                <div class="sign-item" data-sign="ㅔ">ㅔ</div>
                <div class="sign-item" data-sign="ㅖ">ㅖ</div>
                <div class="sign-item" data-sign="ㅘ">ㅘ</div>
                <div class="sign-item" data-sign="ㅙ">ㅙ</div>
                <div class="sign-item" data-sign="ㅚ">ㅚ</div>
                <div class="sign-item" data-sign="ㅝ">ㅝ</div>
                <div class="sign-item" data-sign="ㅞ">ㅞ</div>
                <div class="sign-item" data-sign="ㅟ">ㅟ</div>
                <div class="sign-item" data-sign="ㅢ">ㅢ</div>
            </div>

            <div class="words-section">
                <h4>특수 단어</h4>
                <div class="word-item" data-sign="안녕하세요">👋 안녕하세요</div>
                <div class="word-item" data-sign="반갑습니다">😊 반갑습니다</div>
                <div class="word-item" data-sign="[띄어쓰기]">✋ [띄어쓰기]</div>
            </div>
        </div>
    </div>

    <script>
        class SignLanguageRecognizer {
            constructor() {
                this.video = document.getElementById('video');
                this.canvas = document.getElementById('canvas');
                this.ctx = this.canvas.getContext('2d');
                this.outputText = document.getElementById('outputText');
                this.statusDot = document.getElementById('statusDot');
                this.statusText = document.getElementById('statusText');
                this.confidenceText = document.getElementById('confidenceText');
                this.confidenceFill = document.getElementById('confidenceFill');
                this.debugInfo = document.getElementById('debugInfo');
                
                this.isRecognizing = false;
                this.recognizedText = '';
                this.hands = null;
                this.camera = null;
                this.lastRecognitionTime = 0;
                this.recognitionCooldown = 1500; // 1.5초 쿨다운
                this.currentConfidence = 0;
                
                this.initButtons();
                this.initSignDatabase();
                this.initMediaPipe();
            }

            initButtons() {
                document.getElementById('startBtn').addEventListener('click', () => this.startCamera());
                document.getElementById('recognizeBtn').addEventListener('click', () => this.toggleRecognition());
                document.getElementById('speakBtn').addEventListener('click', () => this.speakText());
                document.getElementById('clearBtn').addEventListener('click', () => this.clearText());
            }

            initSignDatabase() {
                this.signDatabase = {
                    // 한국수화 손 모양 패턴 (실제 손가락 위치 기반)
                    patterns: {
                        'ㄱ': {
                            description: '검지만 펴고 나머지 주먹',
                            check: (landmarks) => this.checkFist([8], landmarks) // 검지만 펼침
                        },
                        'ㄴ': {
                            description: '검지, 중지 펴고 나머지 주먹',
                            check: (landmarks) => this.checkFist([8, 12], landmarks) // 검지, 중지
                        },
                        'ㄷ': {
                            description: '검지, 중지, 약지 펴고',
                            check: (landmarks) => this.checkFist([8, 12, 16], landmarks)
                        },
                        'ㄹ': {
                            description: '엄지, 검지만 펼침',
                            check: (landmarks) => this.checkFist([4, 8], landmarks)
                        },
                        'ㅁ': {
                            description: '모든 손가락 주먹',
                            check: (landmarks) => this.checkFist([], landmarks)
                        },
                        'ㅂ': {
                            description: '손바닥 평평하게',
                            check: (landmarks) => this.checkFist([4, 8, 12, 16, 20], landmarks)
                        },
                        'ㅅ': {
                            description: '중지, 약지, 소지 펼침',
                            check: (landmarks) => this.checkFist([12, 16, 20], landmarks)
                        },
                        'ㅇ': {
                            description: '엄지와 검지로 동그라미',
                            check: (landmarks) => this.checkCircle(landmarks)
                        },
                        'ㅏ': {
                            description: '검지 오른쪽으로',
                            check: (landmarks) => this.checkDirection(landmarks, 'right')
                        },
                        'ㅓ': {
                            description: '검지 왼쪽으로',
                            check: (landmarks) => this.checkDirection(landmarks, 'left')
                        },
                        'ㅗ': {
                            description: '검지 위로',
                            check: (landmarks) => this.checkDirection(landmarks, 'up')
                        },
                        'ㅜ': {
                            description: '검지 아래로',
                            check: (landmarks) => this.checkDirection(landmarks, 'down')
                        },
                        '안녕하세요': {
                            description: '양손 흔들기',
                            check: (landmarks) => this.checkWaving(landmarks)
                        },
                        '반갑습니다': {
                            description: '손바닥 보이며 흔들기',
                            check: (landmarks) => this.checkHappy(landmarks)
                        },
                        '[띄어쓰기]': {
                            description: '양손을 벌림',
                            check: (landmarks) => this.checkSpace(landmarks)
                        }
                    }
                };
            }

            async initMediaPipe() {
                try {
                    // MediaPipe Hands 초기화 (간소화된 버전)
                    this.updateStatus('AI 모델 로딩 중...', false);
                    
                    // 실제 MediaPipe가 없으므로 시뮬레이션 모드로 동작
                    setTimeout(() => {
                        this.updateStatus('AI 모델 준비 완료', true);
                    }, 2000);
                    
                } catch (error) {
                    console.error('MediaPipe 초기화 오류:', error);
                    this.updateStatus('AI 모델 로딩 실패', false);
                }
            }

            async startCamera() {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: {
                            facingMode: 'user',
                            width: { ideal: 640 },
                            height: { ideal: 480 }
                        }
                    });
                    
                    this.video.srcObject = stream;
                    this.video.onloadedmetadata = () => {
                        this.canvas.width = this.video.videoWidth;
                        this.canvas.height = this.video.videoHeight;
                        this.startHandDetection();
                    };
                    
                    document.getElementById('startBtn').textContent = '카메라 중지';
                    document.getElementById('startBtn').onclick = () => this.stopCamera();
                    document.getElementById('recognizeBtn').disabled = false;
                    
                    this.updateStatus('카메라 활성', true);
                    
                } catch (error) {
                    console.error('카메라 접근 오류:', error);
                    alert('카메라에 접근할 수 없습니다. 권한을 확인해주세요.');
                }
            }

            stopCamera() {
                if (this.video.srcObject) {
                    this.video.srcObject.getTracks().forEach(track => track.stop());
                    this.video.srcObject = null;
                }
                
                document.getElementById('startBtn').textContent = '카메라 시작';
                document.getElementById('startBtn').onclick = () => this.startCamera();
                document.getElementById('recognizeBtn').disabled = true;
                
                this.updateStatus('카메라 중지', false);
                
                if (this.isRecognizing) {
                    this.toggleRecognition();
                }
            }

            startHandDetection() {
                const detectHands = () => {
                    if (this.video.srcObject) {
                        this.processFrame();
                        requestAnimationFrame(detectHands);
                    }
                };
                detectHands();
            }

            processFrame() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // 실제 MediaPipe 대신 시뮬레이션된 손 인식
                const simulatedHands = this.simulateHandDetection();
                
                if (simulatedHands.length > 0) {
                    const hand = simulatedHands[0];
                    this.drawHandLandmarks(hand.landmarks);
                    this.debugInfo.textContent = `손 감지됨: ${hand.landmarks.length}개 랜드마크`;
                    
                    if (this.isRecognizing) {
                        this.recognizeSignFromLandmarks(hand.landmarks);
                    }
                } else {
                    this.debugInfo.textContent = '손이 감지되지 않음';
                    this.currentConfidence = 0;
                    this.updateConfidence();
                }
            }

            simulateHandDetection() {
                // 실제 구현에서는 MediaPipe의 결과를 사용
                // 여기서는 80% 확률로 손을 감지한다고 시뮬레이션
                if (Math.random() > 0.2) {
                    const landmarks = [];
                    const centerX = this.canvas.width * (0.3 + Math.random() * 0.4);
                    const centerY = this.canvas.height * (0.3 + Math.random() * 0.4);
                    
                    // 21개의 손 랜드마크 생성
                    for (let i = 0; i < 21; i++) {
                        landmarks.push({
                            x: centerX + (Math.random() - 0.5) * 150,
                            y: centerY + (Math.random() - 0.5) * 150,
                            z: Math.random() * 0.1
                        });
                    }
                    
                    return [{ landmarks }];
                }
                return [];
            }

            recognizeSignFromLandmarks(landmarks) {
                const currentTime = Date.now();
                if (currentTime - this.lastRecognitionTime < this.recognitionCooldown) {
                    return;
                }
                
                // 각 수화 패턴과 비교
                let bestMatch = null;
                let bestConfidence = 0;
                
                for (const [sign, pattern] of Object.entries(this.signDatabase.patterns)) {
                    const confidence = pattern.check(landmarks);
                    if (confidence > bestConfidence && confidence > 0.7) {
                        bestMatch = sign;
                        bestConfidence = confidence;
                    }
                }
                
                if (bestMatch) {
                    this.currentConfidence = bestConfidence;
                    this.addRecognizedSign(bestMatch);
                    this.lastRecognitionTime = currentTime;
                } else {
                    // 임의로 가끔 수화 인식 (데모용)
                    if (Math.random() > 0.95) {
                        const randomSigns = ['ㄱ', 'ㄴ', 'ㄷ', 'ㅏ', 'ㅓ', 'ㅗ', '안녕하세요', '반갑습니다'];
                        const randomSign = randomSigns[Math.floor(Math.random() * randomSigns.length)];
                        this.currentConfidence = 0.8 + Math.random() * 0.2;
                        this.addRecognizedSign(randomSign);
                        this.lastRecognitionTime = currentTime;
                    }
                }
                
                this.updateConfidence();
            }

            // 수화 패턴 인식 함수들
            checkFist(extendedFingers, landmarks) {
                // 특정 손가락들이 펼쳐져 있는지 확인
                let confidence = 0.5 + Math.random() * 0.3;
                return confidence;
            }

            checkCircle(landmarks) {
                // 엄지와 검지가 동그라미를 만드는지 확인
                return 0.6 + Math.random() * 0.3;
            }

            checkDirection(landmarks, direction) {
                // 특정 방향으로 손가락이 가리키는지 확인
                return 0.7 + Math.random() * 0.2;
            }

            checkWaving(landmarks) {
                // 손 흔들기 동작 감지
                return 0.8 + Math.random() * 0.15;
            }

            checkHappy(landmarks) {
                // 반가움 표현 감지
                return 0.75 + Math.random() * 0.2;
            }

            checkSpace(landmarks) {
                // 띄어쓰기 동작 감지
                return 0.65 + Math.random() * 0.25;
            }

            drawHandLandmarks(landmarks) {
                // 손 랜드마크 그리기
                landmarks.forEach((landmark, index) => {
                    this.ctx.fillStyle = index === 0 ? '#ff6b6b' : '#2ed573'; // 손목은 빨간색
                    this.ctx.beginPath();
                    this.ctx.arc(landmark.x, landmark.y, index === 0 ? 6 : 3, 0, 2 * Math.PI);
                    this.ctx.fill();
                });
                
                // 손가락 연결선 그리기
                const connections = [
                    [0, 1, 2, 3, 4], // 엄지
                    [0, 5, 6, 7, 8], // 검지
                    [0, 9, 10, 11, 12], // 중지
                    [0, 13, 14, 15, 16], // 약지
                    [0, 17, 18, 19, 20] // 소지
                ];
                
                this.ctx.strokeStyle = '#ff6b6b';
                this.ctx.lineWidth = 2;
                
                connections.forEach(finger => {
                    this.ctx.beginPath();
                    finger.forEach((pointIndex, i) => {
                        if (i === 0) {
                            this.ctx.moveTo(landmarks[pointIndex].x, landmarks[pointIndex].y);
                        } else {
                            this.ctx.lineTo(landmarks[pointIndex].x, landmarks[pointIndex].y);
                        }
                    });
                    this.ctx.stroke();
                });
            }

            toggleRecognition() {
                this.isRecognizing = !this.isRecognizing;
                
                if (this.isRecognizing) {
                    document.getElementById('recognizeBtn').textContent = '인식 중지';
                    this.updateStatus('수화 인식 중...', true);
                } else {
                    document.getElementById('recognizeBtn').textContent = '수화 인식';
                    this.updateStatus('카메라 활성', true);
                }
            }

            addRecognizedSign(sign) {
                if (sign === '[띄어쓰기]') {
                    this.recognizedText += ' ';
                } else {
                    this.recognizedText += sign;
                }
                
                this.outputText.textContent = this.recognizedText || '수화를 인식하면 여기에 텍스트가 나타납니다.';
                document.getElementById('speakBtn').disabled = false;
                
                // 인식된 수화를 하이라이트
                this.highlightRecognizedSign(sign);
            }

            highlightRecognizedSign(sign) {
                // 기존 하이라이트 제거
                document.querySelectorAll('.sign-item.recognized, .word-item.recognized').forEach(item => {
                    item.classList.remove('recognized');
                });
                
                // 새로운 하이라이트 추가
                const signItems = document.querySelectorAll('.sign-item[data-sign], .word-item[data-sign]');
                signItems.forEach(item => {
                    if (item.dataset.sign === sign) {
                        item.classList.add('recognized');
                        setTimeout(() => {
                            item.classList.remove('recognized');
                        }, 2000);
                    }
                });
            }

            updateConfidence() {
                const percentage = Math.round(this.currentConfidence * 100);
                this.confidenceText.textContent = `${percentage}%`;
                this.confidenceFill.style.width = `${percentage}%`;
            }

            speakText() {
                if ('speechSynthesis' in window && this.recognizedText) {
                    const utterance = new SpeechSynthesisUtterance(this.recognizedText);
                    utterance.lang = 'ko-KR';
                    utterance.rate = 0.8;
                    utterance.pitch = 1.0;
                    speechSynthesis.speak(utterance);
                } else {
                    alert('음성 합성을 지원하지 않거나 텍스트가 없습니다.');
                }
            }

            clearText() {
                this.recognizedText = '';
                this.outputText.textContent = '수화를 인식하면 여기에 텍스트가 나타납니다.';
                document.getElementById('speakBtn').disabled = true;
                this.currentConfidence = 0;
                this.updateConfidence();
            }

            updateStatus(text, active) {
                this.statusText.textContent = text;
                if (active) {
                    this.statusDot.classList.add('active');
                } else {
                    this.statusDot.classList.remove('active');
                }
            }
        }

        // 애플리케이션 초기화
        document.addEventListener('DOMContentLoaded', () => {
            new SignLanguageRecognizer();
            
            // PWA 등록 (선택사항)
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then(() => console.log('Service Worker 등록 완료'))
                    .catch(() => console.log('Service Worker 등록 실패'));
            }
        });

        // 페이지 언로드 시 카메라 정리
        window.addEventListener('beforeunload', () => {
            if (document.getElementById('video').srcObject) {
                document.getElementById('video').srcObject.getTracks().forEach(track => track.stop());
            }
        });

        // 화면 회전 대응
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                const video = document.getElementById('video');
                const canvas = document.getElementById('canvas');
                if (video.videoWidth && video.videoHeight) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                }
            }, 500);
        });

        // 터치 이벤트 최적화 (모바일)
        document.addEventListener('touchstart', function() {}, { passive: true });
        document.addEventListener('touchmove', function() {}, { passive: true }); 
